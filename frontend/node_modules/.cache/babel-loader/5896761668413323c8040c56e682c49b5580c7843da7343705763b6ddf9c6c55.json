{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/\\u0410\\u0434\\u043C\\u0438\\u043D\\u0438\\u0441\\u0442\\u0440\\u0430\\u0442\\u043E\\u0440/Desktop/Study/dev/twelve-project/mesto-react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/\\u0410\\u0434\\u043C\\u0438\\u043D\\u0438\\u0441\\u0442\\u0440\\u0430\\u0442\\u043E\\u0440/Desktop/Study/dev/twelve-project/mesto-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/\\u0410\\u0434\\u043C\\u0438\\u043D\\u0438\\u0441\\u0442\\u0440\\u0430\\u0442\\u043E\\u0440/Desktop/Study/dev/twelve-project/mesto-react/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/\\u0410\\u0434\\u043C\\u0438\\u043D\\u0438\\u0441\\u0442\\u0440\\u0430\\u0442\\u043E\\u0440/Desktop/Study/dev/twelve-project/mesto-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/\\u0410\\u0434\\u043C\\u0438\\u043D\\u0438\\u0441\\u0442\\u0440\\u0430\\u0442\\u043E\\u0440/Desktop/Study/dev/twelve-project/mesto-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useNavigate}from\"react-router-dom\";import React,{useEffect,useState}from\"react\";import PageWithIdentification from\"./PageWithIdentification\";import authenticationApi from\"../../utils/Authentication\";import{jsx as _jsx}from\"react/jsx-runtime\";function Login(_ref){var onLogin=_ref.onLogin,setLoggedIn=_ref.setLoggedIn;var navigate=useNavigate();var _useState=useState({password:\"\",email:\"\"}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},name,value));});}function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var result,userData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.prev=1;_context2.next=4;return authenticationApi.pushLogin(data);case 4:result=_context2.sent;if(!result.token){_context2.next=13;break;}authenticationApi.setToken(result.token);_context2.next=9;return authenticationApi.pullDataAuth();case 9:userData=_context2.sent;onLogin(userData.data.email);setLoggedIn(true);navigate('/main',{replace:true});case 13:_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](1);console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u0438 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F: \".concat(_context2.t0));case 18:case\"end\":return _context2.stop();}},_callee2,null,[[1,15]]);}));return _handleSubmit.apply(this,arguments);}useEffect(function(){var checkToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,userData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:token=localStorage.getItem('jwt');if(!token){_context.next=18;break;}_context.prev=2;authenticationApi.setToken(token);_context.next=6;return authenticationApi.pullDataAuth();case 6:userData=_context.sent;onLogin(userData.data.email);setLoggedIn(true);navigate('/main',{replace:true});_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](2);console.error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F: \".concat(_context.t0));setLoggedIn(false);case 16:_context.next=19;break;case 18:setLoggedIn(false);case 19:case\"end\":return _context.stop();}},_callee,null,[[2,12]]);}));return function checkToken(){return _ref2.apply(this,arguments);};}();checkToken();},[]);return/*#__PURE__*/_jsx(PageWithIdentification,{name:\"\\u0412\\u0445\\u043E\\u0434\",textSubmit:\"\\u0412\\u043E\\u0439\\u0442\\u0438\",signatute:\"\",linkText:\"\",linkTo:\"#\",onSubmit:handleSubmit,onChange:handleChange});}export default Login;","map":{"version":3,"names":["useNavigate","React","useEffect","useState","PageWithIdentification","authenticationApi","jsx","_jsx","Login","_ref","onLogin","setLoggedIn","navigate","_useState","password","email","_useState2","_slicedToArray","data","setData","handleChange","e","_e$target","target","name","value","prevState","_objectSpread","_defineProperty","handleSubmit","_x","_handleSubmit","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","result","userData","wrap","_callee2$","_context2","prev","next","preventDefault","pushLogin","sent","token","setToken","pullDataAuth","replace","t0","console","error","concat","stop","checkToken","_ref2","_callee","_callee$","_context","localStorage","getItem","textSubmit","signatute","linkText","linkTo","onSubmit","onChange"],"sources":["C:/Users/Администратор/Desktop/Study/dev/twelve-project/mesto-react/src/components/landing/Login.js"],"sourcesContent":["import { useNavigate } from \"react-router-dom\";\nimport React, { useEffect, useState } from \"react\";\nimport PageWithIdentification from \"./PageWithIdentification\";\nimport authenticationApi from \"../../utils/Authentication\";\n\nfunction Login({ onLogin, setLoggedIn }) {\n  const navigate = useNavigate();\n  const [data, setData] = useState({\n    password: \"\",\n    email: \"\"\n  });\n\n  function handleChange(e) {\n    const {name, value} = e.target;\n    setData(prevState => ({...prevState, [name]: value}));\n  }\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    try {\n      const result = await authenticationApi.pushLogin(data);\n      if (result.token) {\n        authenticationApi.setToken(result.token);\n        const userData = await authenticationApi.pullDataAuth();\n        onLogin(userData.data.email);\n        setLoggedIn(true);\n        navigate('/main', {replace: true});\n      }\n    } catch (error) {\n      console.error(`Ошибка при отправки данных регистрации пользователя: ${error}`);\n    }\n  }\n\n  useEffect(() => {\n    const checkToken = async () => {\n      const token = localStorage.getItem('jwt');\n      if (token) {\n        try {\n          authenticationApi.setToken(token);\n          const userData = await authenticationApi.pullDataAuth();\n          onLogin(userData.data.email);\n          setLoggedIn(true);\n          navigate('/main', {replace: true});\n        } catch (error) {\n          console.error(`Ошибка при загрузке данных пользователя: ${error}`);\n          setLoggedIn(false);\n        }\n      } else {\n        setLoggedIn(false);\n      }\n    };\n\n    checkToken();\n  }, []);\n\n  return (\n    <PageWithIdentification\n      name=\"Вход\"\n      textSubmit=\"Войти\"\n      signatute=\"\"\n      linkText=\"\"\n      linkTo=\"#\"\n      onSubmit={handleSubmit}\n      onChange={handleChange}\n    />\n  )\n}\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}